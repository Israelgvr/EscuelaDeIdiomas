"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const I18n_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Addons/I18n"));
class DetectUserLocale {
    getUserLanguage(ctx) {
        const availableLocales = I18n_1.default.supportedLocales();
        return ctx.request.language(availableLocales) || ctx.request.input('lang');
    }
    async handle(ctx, next) {
        const language = this.getUserLanguage(ctx);
        if (language) {
            ctx.i18n.switchLocale(language);
        }
        await next();
    }
}
exports.default = DetectUserLocale;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGV0ZWN0VXNlckxvY2FsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkRldGVjdFVzZXJMb2NhbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxvRkFBMEM7QUFjMUMsTUFBcUIsZ0JBQWdCO0lBUXpCLGVBQWUsQ0FBQyxHQUF3QjtRQUNoRCxNQUFNLGdCQUFnQixHQUFHLGNBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFBO1FBQ2hELE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUM1RSxDQUFDO0lBTU0sS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUF3QixFQUFFLElBQXlCO1FBQ3JFLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUE7UUFNMUMsSUFBSSxRQUFRLEVBQUU7WUFDWixHQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQTtTQUNoQztRQVNELE1BQU0sSUFBSSxFQUFFLENBQUE7SUFDZCxDQUFDO0NBQ0Y7QUFyQ0QsbUNBcUNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEkxOG4gZnJvbSAnQGlvYzpBZG9uaXMvQWRkb25zL0kxOG4nXG5pbXBvcnQgeyBIdHRwQ29udGV4dENvbnRyYWN0IH0gZnJvbSAnQGlvYzpBZG9uaXMvQ29yZS9IdHRwQ29udGV4dCdcblxuLyoqXG4gKiBUaGUgbWlkZGxld2FyZSBkZXRlY3RzIHRoZSB1c2VyIGxhbmd1YWdlIHVzaW5nIHRoZSBcIkFjY2VwdC1sYW5ndWFnZVwiIEhUVFAgaGVhZGVyXG4gKiBvciB0aGUgXCJsYW5nXCIgcXVlcnkgc3RyaW5nIHBhcmFtZXRlci5cbiAqXG4gKiBGZWVsIGZyZWUgdG8gY2hhbmdlIHRoZSBtaWRkbGV3YXJlIGltcGxlbWVudGF0aW9uIHRvIHdoYXQgc3VpdHMgeW91ciBuZWVkcy4gSnVzdFxuICogbWFrZSBzdXJlXG4gKlxuICogLSBZb3UgYWx3YXlzIGVuc3VyZSB0aGUgdXNlciBzZWxlY3RlZCBsYW5ndWFnZSBpcyBzdXBwb3J0ZWQgYnkgeW91ciBhcHAuXG4gKiAtIE9ubHkgY2FsbCBcInN3aXRjaExvY2FsZVwiIHdoZW4gdGhlIGRldGVjdGVkIGxhbmd1YWdlIGlzIHZhbGlkIHN0cmluZyB2YWx1ZSBhbmRcbiAqICAgbm90IFwibnVsbFwiIG9yIFwidW5kZWZpbmVkXCJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGV0ZWN0VXNlckxvY2FsZSB7XG4gIC8qKlxuICAgKiBEZXRlY3QgdXNlciBsYW5ndWFnZSB1c2luZyBcIkFjY2VwdC1sYW5ndWFnZVwiIGhlYWRlciBvclxuICAgKiB0aGUgXCJsYW5nXCIgcXVlcnkgc3RyaW5nIHBhcmFtZXRlci5cbiAgICpcbiAgICogVGhlIHVzZXIgbGFuZ3VhZ2UgbXVzdCBiZSBwYXJ0IG9mIHRoZSBcInN1cHBvcnRlZExvY2FsZXNcIiwgb3RoZXJ3aXNlXG4gICAqIHRoaXMgbWV0aG9kIHNob3VsZCByZXR1cm4gbnVsbC5cbiAgICovXG4gIHByb3RlY3RlZCBnZXRVc2VyTGFuZ3VhZ2UoY3R4OiBIdHRwQ29udGV4dENvbnRyYWN0KSB7XG4gICAgY29uc3QgYXZhaWxhYmxlTG9jYWxlcyA9IEkxOG4uc3VwcG9ydGVkTG9jYWxlcygpXG4gICAgcmV0dXJuIGN0eC5yZXF1ZXN0Lmxhbmd1YWdlKGF2YWlsYWJsZUxvY2FsZXMpIHx8IGN0eC5yZXF1ZXN0LmlucHV0KCdsYW5nJylcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgbWV0aG9kIGlzIGNhbGxlZCBieSBBZG9uaXNKUyBhdXRvbWF0aWNhbGx5IG9uIGV2ZXJ5IG1pZGRsZXdhcmVcbiAgICogY2xhc3MuXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaGFuZGxlKGN0eDogSHR0cENvbnRleHRDb250cmFjdCwgbmV4dDogKCkgPT4gUHJvbWlzZTx2b2lkPikge1xuICAgIGNvbnN0IGxhbmd1YWdlID0gdGhpcy5nZXRVc2VyTGFuZ3VhZ2UoY3R4KVxuXG4gICAgLyoqXG4gICAgICogU3dpdGNoIGxvY2FsZSB3aGVuIHdlIGFyZSBhYmxlIHRvIGRldGVjdCB0aGUgdXNlciBsYW5ndWFnZSBhbmQgaXRcbiAgICAgKiBpcyBzdXBwb3J0ZWQgYnkgdGhlIGFwcGxpY2F0aW9uXG4gICAgICovXG4gICAgaWYgKGxhbmd1YWdlKSB7XG4gICAgICBjdHguaTE4bi5zd2l0Y2hMb2NhbGUobGFuZ3VhZ2UpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hhcmUgaTE4biB3aXRoIHZpZXdcbiAgICAgKi9cbiAgICAvLyBpZiAoJ3ZpZXcnIGluIGN0eCkge1xuICAgIC8vICAgY3R4LnZpZXcuc2hhcmUoeyBpMThuOiBjdHguaTE4biB9KVxuICAgIC8vIH1cblxuICAgIGF3YWl0IG5leHQoKVxuICB9XG59XG4iXX0=